# Marlin Ender 5 Pro Config

This repository contains a configuration to build Marlin for the [Ender 5 Pro](https://www.creality.com/goods-detail/ender-5-pro-3d-printer) with [BLTouch](https://www.amazon.co.uk/dp/B08S2YTQJY) for auto bed leveling for the V422 board without the bltouch adapter board. The one I am using is the V3.1 for 32 Bit V4.2.2/V4.2.7 Mainboard. There are a few different versions but the one lnked above connects directly to the V4.2.2 mainboard and using the PB1 pin in the updated Marlin config in this repository.

To build run [./build.sh](build.sh) and copy the generated bin file to your SD card. 
To flash to your Ender 5 pro just insert the SD card and turn on the Ender 5.

The Configuration in this repository already contains the enablement of the BLTouch. The Config was generated using: 

``` 
git clone git@github.com:MarlinFirmware/Configurations.git
git checkout release-2.0.9.3
```

The contents of [fixes.patch](fixes.patch) were then applied.

# Installing the BLTouch Hardware

See [here](https://www.crealityexperts.com/installing-bltouch-ender-5-pro). You can replace the firmware .bin in that guide with the one generated by [./build.sh](build.sh).

# Setting the Z-Offset

You will need to calculate the z-offset for the BLTouch and save it on your printer. You can do that following the guide  [here](https://makemendel.com/marlin-z-offset/).


# Using Cura

I'm using [octoprint](https://octoprint.org/) on a Pi 4. When using with an Ender 5 Pro the USB on the Pi back feeds power to the printer. Using a USB power blocker [adapter](https://www.amazon.co.uk/PortaPow-USB-Power-Blocker-Cased/dp/B094FYL9QT) fixes the back powering.

To use [Cura](https://ultimaker.com/software/ultimaker-cura) I installed [OctoPrint Connection Plugin](https://marketplace.ultimaker.com/app/cura/plugins/fieldofview/OctoPrintPlugin) via the Cura Marketplace. The printer needs to be added as a local Ender 5 and then configured under manage printers -> Connect to OctoPrint.

To enable Auto Bed Leveling in Cura you need to add `G29 ;Leveling` code under `G28 ;Home` in Start G-Code under the machine settings menu.
